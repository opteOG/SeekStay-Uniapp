{"version":3,"file":"DatePicker.js","sources":["components/DatePicker/DatePicker.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovcHJvamVjdF9hbGwvU2Vla1N0YXkvc2Vla3N0YXkvY29tcG9uZW50cy9EYXRlUGlja2VyL0RhdGVQaWNrZXIudnVl"],"sourcesContent":["<template>\n  <view class=\"calendar\">\n    <!-- 头部：月份和左右切换按钮 -->\n    <view class=\"calendar-header\">\n      <button @click=\"prevMonth\" class=\"calendar-nav-button\" :disabled=\"isPrevDisabled\">\r\n\t\t\t\t<uni-icons type=\"left\"></uni-icons>\r\n\t\t\t</button>\n      <text>{{ year }}年 {{ month + 1 }}月</text>\n      <button @click=\"nextMonth\" class=\"calendar-nav-button\" :disabled=\"isNextDisabled\">\r\n\t\t\t\t<uni-icons type=\"right\"></uni-icons>\r\n\t\t\t</button>\n    </view>\n\n    <!-- 星期标题 -->\n    <view class=\"calendar-weekdays\">\n      <text v-for=\"(day, index) in weekDays\" :key=\"index\">{{ day }}</text>\n    </view>\n\n    <!-- 日期展示 -->\n    <view class=\"calendar-dates\">\n      <view v-for=\"(day, index) in monthDays\" :key=\"index\" class=\"calendar-day\"\n        :class=\"{\n          'calendar-day-selected': isSelected(day),\n          'calendar-day-range': isInRange(day),\n          'calendar-day-disabled': isDisabled(day),\n          'calendar-day-start': isStart(day),\n          'calendar-day-end': isEnd(day)\n        }\"\n        @click=\"selectDate(day)\">\n        <text v-if=\"day\">{{ day.getDate() }}</text>\n      </view>\r\n\t\t\t\r\n    </view>\r\n\t\t<view class=\"tail\">\r\n\t\t\t<view class=\"clear\" @click=\"resetToCurrent\">清除日期</view>\r\n\t\t\t<view class=\"total-days\">共休息<text class=\"total\">{{ totalDays || '?' }}</text>晚</view>\r\n\t\t</view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue';\nimport { useOrderStore } from '../../store/orderStore';\n\n// 获取当前日期\nconst today = new Date();\nconst startDate = ref(null);\nconst endDate = ref(null);\nconst currentDate = ref(new Date(today.getFullYear(), today.getMonth(), 1));\nconst twoYearsLater = new Date(today.getFullYear() + 2, today.getMonth(), today.getDate());\n\r\n// -----------------------------耦合部分-----------------------------\r\nconst orderStore = useOrderStore()\r\n\nconst weekDays = ['一', '二', '三', '四', '五', '六', '日'];\n\nconst year = computed(() => currentDate.value.getFullYear());\nconst month = computed(() => currentDate.value.getMonth());\nconst totalDays = computed(() => {\n  if (!startDate.value || !endDate.value) return '?';\n  const timeDiff = endDate.value.getTime() - startDate.value.getTime();\n  const dayDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));\n  return dayDiff;\n});\n// 获取当月的第一天和最后一天\nconst firstDayOfMonth = computed(() => new Date(year.value, month.value, 1));\nconst lastDayOfMonth = computed(() => new Date(year.value, month.value + 1, 0));\n\n// 计算日历数据，只显示当月的日期\nconst monthDays = computed(() => {\n  let dates = [];\n  let firstDay = firstDayOfMonth.value;\n  let lastDay = lastDayOfMonth.value;\n\n  // 获取第一天的星期索引（0: 周日, 1: 周一, ..., 6: 周六）\n  let firstWeekday = firstDay.getDay();\n  firstWeekday = firstWeekday === 0 ? 7 : firstWeekday; // 让周日变成 7，确保排列从周一开始\n\n  // 填充前面的空白\n  for (let i = 1; i < firstWeekday; i++) {\n    dates.push(null);\n  }\n\n  // 填充当月日期\n  for (let i = 1; i <= lastDay.getDate(); i++) {\n    dates.push(new Date(year.value, month.value, i));\n  }\n\n  return dates;\n});\n\n// 判断是否选中\nconst isSelected = (date) => date && startDate.value && startDate.value.toDateString() === date.toDateString();\n\n// 判断是否在选中范围内\nconst isInRange = (date) => date && startDate.value && endDate.value && date > startDate.value && date < endDate.value;\n\n// 判断是否是开始或结束\nconst isStart = (date) => date && startDate.value && startDate.value.toDateString() === date.toDateString();\nconst isEnd = (date) => date && endDate.value && endDate.value.toDateString() === date.toDateString();\n\n// 判断是否禁用\nconst isDisabled = (date) => !date || date < today || date > twoYearsLater;\n\n// 选择日期\nconst selectDate = (date) => {\n  if (!date || isDisabled(date)) return;\n  if (!startDate.value || (startDate.value && endDate.value)) {\n    startDate.value = date;\n    endDate.value = null;\n  } else {\n    if (date > startDate.value) {\n      endDate.value = date;\n    } else if(date < startDate.value) {\n      endDate.value = startDate.value;\n      startDate.value = date;\n    }\n  }\r\n\t// ------------------------------------耦合部分-------------------------------------------------\r\n\torderStore.setTime(startDate.value, endDate.value, totalDays.value)\n};\n\n// 上个月\nconst prevMonth = () => {\n  let prev = new Date(year.value, month.value - 1, 1);\n  let minDate = new Date(today.getFullYear(), today.getMonth(), 1); // 当前月的 1 号\n  if (prev >= minDate) {\n    currentDate.value = prev;\n  }\n};\n\n// 下个月\nconst nextMonth = () => {\n  let next = new Date(year.value, month.value + 1, 1);\n  if (next <= twoYearsLater) {\n    currentDate.value = next;\n  }\n};\n\n// 返回当前月份\nconst resetToCurrent = () => {\r\n\tstartDate.value = null;\r\n\tendDate.value = null;\n  currentDate.value = new Date(today.getFullYear(), today.getMonth(), 1);\n};\n\n// 是否禁用上一月/下一月按钮\nconst isPrevDisabled = computed(() => {\n  let minDate = new Date(today.getFullYear(), today.getMonth(), 1); // 当前月的 1 号\n  return currentDate.value <= minDate; // 只在当前月才禁用\n});\nconst isNextDisabled = computed(() => new Date(year.value, month.value + 1, 1) > twoYearsLater);\n</script>\n\n<style lang=\"scss\" scoped>\n.calendar {\n  padding: 20rpx;\n  border-radius: 20rpx;\n  background-color: #fcf8ee;\r\n\tfont-family: '本墨绪圆';\r\n\t\r\n\t.tail {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 40rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\t.clear {\r\n\t\t\tcursor: pointer;\r\n\t\t\t&:active {\r\n\t\t\t\tcolor: red;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.total-days {\r\n\t\t\t.total {\r\n\t\t\t\tfont-size: 35rpx;\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t\tcolor: #8c8172;\r\n\t\t\t}\r\n\t\t}\r\n\t}\n}\n\n.calendar-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-bottom: 10px;\n\tfont-size: 36rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #c5b6a0;\n  .calendar-nav-button {\n    background-color: transparent;\n    border: none;\n    cursor: pointer;\n    &:disabled {\n      color: #dddddd;\n      cursor: not-allowed;\n    }\r\n\t\t&:after {\r\n\t\t\tborder: none;\r\n\t\t}\n  }\n\n}\n\n.calendar-weekdays {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  text-align: center;\n  font-weight: 600;\r\n\tfont-size: 24rpx;\n}\n\n.calendar-dates {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  gap: 5px;\n  text-align: center;\r\n\tfont-size: 20rpx;\n}\n\n.calendar-day {\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 4px;\n\n  &-selected {\n    background-color: #c5b6a0;\n    color: white;\n  }\n\n  &-range {\n    background-color: #d9cfaa;\n  }\n\n  &-start,\n  &-end {\n    background-color: #c5b6a0;\n    color: white;\n  }\n\n  &-disabled {\n    color: #ccc;\n    cursor: not-allowed;\n  }\n}\n</style>\n","import Component from 'E:/project_all/SeekStay/seekstay/components/DatePicker/DatePicker.vue'\nwx.createComponent(Component)"],"names":["ref","useOrderStore","computed"],"mappings":"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"}