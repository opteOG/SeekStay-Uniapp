{"version":3,"file":"profile.js","sources":["pages/profile/profile.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9wcm9maWxlLnZ1ZQ"],"sourcesContent":[" <template>\n  <view class=\"profile\">\r\n\t\t<!-- 导航栏 -->\r\n\t\t<uni-nav-bar\r\n\t\t  dark\r\n\t\t  :fixed=\"true\"\r\n\t\t  shadow\r\n\t\t  background-color=\"#c5b6a0\"\r\n\t\t  status-bar\r\n\t\t  left-icon=\"left\"\r\n\t\t  left-text=\"返回\"\r\n\t\t  title=\"个人主页\"\r\n\t\t  @clickLeft=\"handleBack\"\r\n\t\t/>\r\n\t\t<view class=\"avatar\">\r\n\t\t\t<image @click=\"handleUpload\" :src=\"userStore.avatarUrl\" mode=\"aspectFill\" :key=\"randow\"></image>\r\n\t\t</view>\r\n\t\t<view class=\"name\">\r\n\t\t\t<view class=\"user-name\">{{ userStore.name }}</view>\r\n\t\t\t<text>用户名</text>\r\n\t\t</view>\r\n\t\t<view class=\"edit\">\r\n\t\t\t<button class=\"edit-btn btn\" type=\"default\" @click=\"handleEditClick\">编辑个人信息</button>\r\n\t\t</view>\r\n\t\t<view class=\"user-message\">\r\n\t\t\t<view class=\"item\">\r\n\t\t\t\t<view class=\"item-title\">\r\n\t\t\t\t\t<image src=\"/static/img/userMessage.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"\">个人介绍</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"introduce\">{{ userStore.introduce }}</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"item\">\r\n\t\t\t\t<view class=\"item-title\">\r\n\t\t\t\t\t<image src=\"/static/img/phone.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"\">联系电话</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"phone\">{{ userStore.phoneNumber }}</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"item\">\r\n\t\t\t\t<view class=\"item-title\">\r\n\t\t\t\t\t<image src=\"/static/img/email.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"email\">邮箱地址</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view>{{ userStore.email }}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"logout\">\r\n\t\t\t<button class=\"logout-btn btn\" type=\"default\" @click=\"handleLogout\">退出登录</button>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script setup>\nimport { onLoad, onShow, onPullDownRefresh } from '@dcloudio/uni-app'\r\nimport { tokenNavigateTo } from '@/utils/tokenNavigateTo.js'\r\nimport { ref } from 'vue'\nimport { useUserStore } from '@/store/userStore.js'\n\r\n\r\nconst userStore = useUserStore()\r\nconst randow = ref(Math.random())\r\n\r\nonPullDownRefresh(() => {\r\n\trandow.value = Math.random()\r\n\tsetTimeout(() => {\r\n\t\tuni.stopPullDownRefresh()\r\n\t}, 1000)\r\n})\r\n\r\nonShow(async () => {\r\n\tconst token = uni.getStorageSync('user_token')\r\n\tif(!token) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: \"请登录后查看\",\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t\tuni.redirectTo({\r\n\t\t\turl: '/subPackages/user/login/login'\r\n\t\t})\r\n\t}\r\n\t// 获取个人信息\r\n\tconst res = await userStore.fetchUserData()\r\n\tif(res.status === 401 && token) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '登录已过期，请重新登录',\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t\tuni.redirectTo({\r\n\t\t\turl: '/subPackages/user/login/login'\r\n\t\t})\r\n\t}\r\n\t\r\n\tuni.hideTabBar()\r\n})\r\n\r\nconst handleBack = () => {\r\n\tuni.showTabBar()\r\n  uni.switchTab({\r\n  \turl: '/pages/search/search'\r\n  })\n};\r\n\r\n// 处理编辑按钮点击\r\nconst handleEditClick = () => {\r\n\tuni.navigateTo({\r\n\t\turl: '/subPackages/person/edit-user-message/edit-user-message'\r\n\t})\r\n}\r\n\r\n// 处理退出登录事件\r\nconst handleLogout = () => {\r\n\tuni.removeStorageSync('user_token')\r\n\tuni.switchTab({\r\n\t\turl: '/pages/search/search'\r\n\t})\r\n\tuni.showTabBar()\r\n}\r\n\r\n\r\n// 处理头像上传\r\nconst handleUpload = () => {\r\n\tuni.navigateTo({\r\n\t\turl: '/subPackages/person/crop-image/crop-image'\r\n\t})\r\n}\r\n\n</script>\n\n<style scoped lang=\"scss\">\r\n\r\n.profile {\r\n\tpadding: 0 40rpx 80rpx ;\r\n\tbackground: linear-gradient(to right, #c5b6a0, #fde9cf, #c5b6a0);\r\n\tfont-family: '本墨绪圆';\r\n\t.avatar {\r\n\t\ttext-align: center;\r\n\t\tmargin-top: 40rpx;\r\n\t\timage {\r\n\t\t\theight: 400rpx;\r\n\t\t\twidth: 400rpx;\r\n\t\t\tborder-radius: 100%;\r\n\t\t\tborder: 6rpx solid rgba(255, 255, 255, 0.8);\r\n\t\t\tbox-shadow: 0 0 8rpx 8rpx rgba(0, 0, 0, 0.4);\r\n\t\t\tcursor: pointer;\r\n\t\t}\r\n\t}\r\n\t.btn {\r\n\t\theight: 80rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t.name {\r\n\t\tmargin-top: 80rpx;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: 450;\r\n\t\tcolor: #9e9182;\r\n\t\t.user-name {\r\n\t\t\tfont-size: 60rpx;\r\n\t\t\tfont-weight: 500;\r\n\t\t}\r\n\t}\r\n\t.edit {\r\n\t\tmargin-top: 40rpx;\r\n\t\ttext-align: center;\r\n\t\t.edit-btn {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\twidth: 600rpx;\r\n\t\t\tbackground-color: #ac9e8c;\r\n\t\t\tborder-radius: 50rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tfont-weight: 500;\r\n\t\t}\r\n\t}\r\n\t.user-message {\r\n\t\tmargin-top: 80rpx;\r\n\t\timage {\r\n\t\t\twidth: 60rpx;\r\n\t\t\theight: 60rpx;\r\n\t\t\tmargin-right: 20rpx;\r\n\t\t}\r\n\t\t.item {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t\tmargin-top: 40rpx;\r\n\t\t\t.item-title {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\t\t\t.introduce {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tmargin-left: 20rpx;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t.logout {\r\n\t\tmargin-top: 40rpx;\r\n\t\ttext-align: center;\r\n\t\t.logout-btn {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\twidth: 600rpx;\r\n\t\t\tbackground-color: #ac9e8c;\r\n\t\t\tborder-radius: 50rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tfont-weight: 500;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n</style>\n","import MiniProgramPage from 'E:/project_all/SeekStay/seekstay/pages/profile/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","onPullDownRefresh","uni","onShow"],"mappings":";;;;;;;;;;;;;;;AA4DA,UAAM,YAAYA,gBAAAA,aAAc;AAChC,UAAM,SAASC,cAAG,IAAC,KAAK,QAAQ;AAEhCC,kBAAAA,kBAAkB,MAAM;AACvB,aAAO,QAAQ,KAAK,OAAQ;AAC5B,iBAAW,MAAM;AAChBC,sBAAAA,MAAI,oBAAqB;AAAA,MACzB,GAAE,GAAI;AAAA,IACR,CAAC;AAEDC,kBAAAA,OAAO,YAAY;AAClB,YAAM,QAAQD,cAAAA,MAAI,eAAe,YAAY;AAC7C,UAAG,CAAC,OAAO;AACVA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACR,CAAG;AAAA,MACD;AAED,YAAM,MAAM,MAAM,UAAU,cAAe;AAC3C,UAAG,IAAI,WAAW,OAAO,OAAO;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACR,CAAG;AAAA,MACD;AAEDA,oBAAAA,MAAI,WAAY;AAAA,IACjB,CAAC;AAED,UAAM,aAAa,MAAM;AACxBA,oBAAAA,MAAI,WAAY;AACfA,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAK;AAAA,MACR,CAAG;AAAA,IACH;AAGA,UAAM,kBAAkB,MAAM;AAC7BA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACP,CAAE;AAAA,IACF;AAGA,UAAM,eAAe,MAAM;AAC1BA,oBAAG,MAAC,kBAAkB,YAAY;AAClCA,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAK;AAAA,MACP,CAAE;AACDA,oBAAAA,MAAI,WAAY;AAAA,IACjB;AAIA,UAAM,eAAe,MAAM;AAC1BA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACP,CAAE;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5HA,GAAG,WAAW,eAAe;"}