{"version":3,"file":"trip.js","sources":["pages/trip/trip.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdHJpcC90cmlwLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"trip\">\r\n\t\t<!-- 导航栏 -->\r\n\t\t<uni-nav-bar\r\n\t\t\tshadow=\"true\"\r\n\t\t  dark\r\n\t\t  :fixed=\"true\"\r\n\t\t  background-color=\"#c5b6a0\"\r\n\t\t  status-bar\r\n\t\t  title=\"我的行程\"\r\n\t\t/>\r\n\t\t<view class=\"empty\" v-if=\"!tripStore.orderList.length\">\r\n\t\t\t<view class=\"title\">\r\n\t\t\t\t尚未预定任何行程！\r\n\t\t\t</view>\r\n\t\t\t<view class=\"content\">\r\n\t\t\t\t是时候拿出你的行李箱，着手规划下一趟行程了。\r\n\t\t\t</view>\r\n\t\t\t<view>\r\n\t\t\t\t<button class=\"btn\" type=\"default\" @click=\"handleEmptyClick\">开始探索</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"trip-list\" v-else>\r\n\t\t\t<template v-for=\"(item, index) in tripStore.orderList\" :key=\"item.id\">\r\n\t\t\t\t<view class=\"trip-item\">\r\n\t\t\t\t\t<trip-item @delete=\"handleTripDelete(index)\" :orderData=\"item\" :detailData=\"tripStore.tripDataList[index]\"></trip-item>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script setup>\nimport { onShow, onLoad, onPullDownRefresh } from '@dcloudio/uni-app'\r\nimport { useTripStore } from '../../store/tripStore'\nimport { useUserStore } from '../../store/userStore'\nimport { computed } from 'vue'\nimport requestService from '@/service/index.js'\r\n\r\nconst tripStore = useTripStore()\r\nconst userStore = useUserStore()\r\n\r\nonPullDownRefresh(() => {\r\n\ttripStore.fetchOrderList()\r\n\ttripStore.fetchTripDataList()\r\n\tsetTimeout(() => {\r\n\t\tuni.stopPullDownRefresh()\r\n\t}, 1000)\r\n})\r\n\r\nonLoad(async () => {\r\n await tripStore.fetchOrderList()\r\n await tripStore.fetchTripDataList()\r\n})\r\n\r\nonShow(async () => {\r\n\tconst token = uni.getStorageSync('user_token')\r\n\tif(!token) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: \"请登录后查看\",\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t\tuni.redirectTo({\r\n\t\t\turl: '/subPackages/user/login/login'\r\n\t\t})\r\n\t}\r\n\t// 获取个人信息\r\n\tconst res = await userStore.fetchUserData()\r\n\tif(res.status === 401 && token) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '登录已过期，请重新登录',\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t\tuni.redirectTo({\r\n\t\t\turl: '/subPackages/user/login/login'\r\n\t\t})\r\n\t}\r\n})\r\n\r\nconst handleEmptyClick = () => {\r\n\tuni.switchTab({\r\n\t\turl: '/pages/search/search'\r\n\t})\r\n}\r\n\r\nconst handleTripDelete = async (id) => {\r\n\tawait requestService.delete('/order', {}, {\r\n\t\torderNumber: tripStore.orderList[id].orderNumber\r\n\t})\r\n\ttripStore.orderList.splice(id, 1)\r\n\tuni.showToast({\r\n\t\ttitle: '行程删除成功'\r\n\t})\r\n}\r\n\n</script>\n\n<style scoped lang=\"scss\">\r\n\r\n.trip {\r\n\tpadding: 0 20rpx 20rpx;\r\n\t.empty {\r\n\t\tmargin-top: 100rpx;\r\n\t\ttext-align: center;\r\n\t\t.title {\r\n\t\t\tfont-size: 48rpx;\r\n\t\t}\r\n\t\t.content {\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\t\t.btn {\r\n\t\t\twidth: 300rpx;\r\n\t\t\theight: 80rpx;\r\n\t\t\tmargin-top: 40rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n</style>\n","import MiniProgramPage from 'E:/project_all/SeekStay/seekstay/pages/trip/trip.vue'\nwx.createPage(MiniProgramPage)"],"names":["useTripStore","useUserStore","onPullDownRefresh","uni","onLoad","onShow","requestService"],"mappings":";;;;;;;;;;;;;;;;;;AAuCA,UAAM,YAAYA,gBAAAA,aAAc;AAChC,UAAM,YAAYC,gBAAAA,aAAc;AAEhCC,kBAAAA,kBAAkB,MAAM;AACvB,gBAAU,eAAgB;AAC1B,gBAAU,kBAAmB;AAC7B,iBAAW,MAAM;AAChBC,sBAAAA,MAAI,oBAAqB;AAAA,MACzB,GAAE,GAAI;AAAA,IACR,CAAC;AAEDC,kBAAAA,OAAO,YAAY;AAClB,YAAM,UAAU,eAAgB;AAChC,YAAM,UAAU,kBAAmB;AAAA,IACpC,CAAC;AAEDC,kBAAAA,OAAO,YAAY;AAClB,YAAM,QAAQF,cAAAA,MAAI,eAAe,YAAY;AAC7C,UAAG,CAAC,OAAO;AACVA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACR,CAAG;AAAA,MACD;AAED,YAAM,MAAM,MAAM,UAAU,cAAe;AAC3C,UAAG,IAAI,WAAW,OAAO,OAAO;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACR,CAAG;AAAA,MACD;AAAA,IACF,CAAC;AAED,UAAM,mBAAmB,MAAM;AAC9BA,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAK;AAAA,MACP,CAAE;AAAA,IACF;AAEA,UAAM,mBAAmB,OAAO,OAAO;AACtC,YAAMG,6BAAe,OAAO,UAAU,IAAI;AAAA,QACzC,aAAa,UAAU,UAAU,EAAE,EAAE;AAAA,MACvC,CAAE;AACD,gBAAU,UAAU,OAAO,IAAI,CAAC;AAChCH,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,MACT,CAAE;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5FA,GAAG,WAAW,eAAe;"}