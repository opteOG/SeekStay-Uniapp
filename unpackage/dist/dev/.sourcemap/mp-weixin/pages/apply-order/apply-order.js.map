{"version":3,"file":"apply-order.js","sources":["pages/apply-order/apply-order.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYXBwbHktb3JkZXIvYXBwbHktb3JkZXIudnVl"],"sourcesContent":["<template>\n\t<view class=\"apply-order\"> \n\t\t<!-- 导航栏 -->\r\n\t\t<uni-nav-bar\r\n\t\t  dark\r\n\t\t  :fixed=\"true\"\r\n\t\t  background-color=\"#c5b6a0\"\r\n\t\t  status-bar\r\n\t\t  left-icon=\"left\"\r\n\t\t  left-text=\"返回\"\r\n\t\t  title=\"预定申请\"\r\n\t\t  @clickLeft=\"handleBack\"\r\n\t\t/>\r\n\t\t<!-- 头部信息 -->\r\n\t\t<view class=\"header bar\">\r\n\t\t\t<view class=\"part1\">\r\n\t\t\t\t<image class=\"img\" :src=\"roomData.imgUrl[0]\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t<view class=\"text\">\r\n\t\t\t\t\t<view class=\"part1-title\">{{ roomData.location }}</view>\r\n\t\t\t\t\t<view class=\"desc\">{{ roomData.description }}</view>\r\n\t\t\t\t\t<view class=\"score\">\r\n\t\t\t\t\t\t<uni-rate value=\"1\" max=\"1\" active-color=\"#000\" readonly=\"true\"></uni-rate>\r\n\t\t\t\t\t\t<text>{{ roomData.score }} 超赞房东√</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"part2\">\r\n\t\t\t\t<view class=\"text\">24小时内可免费取消订单。请注意！！！订单支付后，无法取消订单。</view>\r\n\t\t\t\t<image src=\"/static/img/calender.png\" mode=\"aspectFill\"></image>\r\n\t\t\t</view>\r\n\t\t</view>\n\t\t<!-- 行程信息 -->\r\n\t\t<view class=\"trip-message bar\">\r\n\t\t\t<view class=\"title\">您的行程</view>\r\n\t\t\t<view class=\"date\">\r\n\t\t\t\t<view class=\"part\">\r\n\t\t\t\t\t<view class=\"tag\">日期</view>\r\n\t\t\t\t\t<view class=\"content\">{{ formatDate(orderStore.startTime) }}至{{ formatDate(orderStore.endTime) }}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"part\">\r\n\t\t\t\t\t<view class=\"tag\">房客</view>\r\n\t\t\t\t\t<view class=\"content\">一位房客</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 价格详情 -->\r\n\t\t<view class=\"price-detail bar\">\r\n\t\t\t<view class=\"title\">价格详情</view>\r\n\t\t\t\t\t<view class=\"item\">\r\n\t\t\t\t\t\t<view class=\"key\">￥{{ formatPrice(roomData.price) }} × {{ orderStore.totalDays }}晚</view>\r\n\t\t\t\t\t\t<view class=\"value\">共计：￥{{ formatPrice(homeTotalPrice) }}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"item\">\r\n\t\t\t\t\t\t<view class=\"key\">寻栖服务费</view>\r\n\t\t\t\t\t\t<view class=\"value\">共计：￥{{ formatPrice(servicePrice) }}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"item\">\r\n\t\t\t\t\t\t<view class=\"key\">税费</view>\r\n\t\t\t\t\t\t<view class=\"value\">共计：￥{{ formatPrice(taxPrice) }}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"item end\">\r\n\t\t\t\t\t\t<view class=\"key\">总计</view>\r\n\t\t\t\t\t\t<view class=\"value\">￥{{ formatPrice(totalPrice) }}</view>\r\n\t\t\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 基本规则 -->\r\n\t\t<view class=\"base-rule bar\">\r\n\t\t\t<view class=\"title\">基本规则</view>\r\n\t\t\t<view class=\"desc\">请每位房客留意遵守几个简单要求，做一名优秀的房⁠客。</view>\r\n\t\t\t<view class=\"list\">\r\n\t\t\t\t<view class=\"item\">· 遵守入住须知</view>\r\n\t\t\t\t<view class=\"item\">. 像对待自己的家一样对待房东的房源</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 确认订单 -->\r\n\t\t<view class=\"confirm-order bar\">\r\n\t\t\t<view class=\"remind\">点击下方按钮即代表您同意房东的入住须知、房客基本规则、\n寻栖重新预订和退款政策，且如果我对损坏负有责任，寻栖可以从我的付款方式中扣款。</view>\r\n\t\t\t<view>\r\n\t\t\t\t<button class=\"order-btn\" type=\"default\" @click=\"handleOrderClick\">确认订单</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script setup>\nimport { computed, ref } from 'vue';\nimport { useOrderStore } from '../../store/orderStore';\nimport { onLoad } from '@dcloudio/uni-app'\nimport { formatDate } from '../../utils/formatDate';\r\nimport { formatPrice } from '../../utils/formatPrice.js'\r\nimport requestService from '@/service/index.js'\r\n\r\nconst orderStore = useOrderStore()\r\nconst roomData = ref()\r\n// 租房总价\r\nconst homeTotalPrice = computed(() => {\r\n\treturn roomData.value.price * orderStore.totalDays\r\n})\r\n// 服务费\r\nconst servicePrice = computed(() => {\r\n\treturn homeTotalPrice.value * 0.05\r\n})\r\n// 税费 \r\nconst taxPrice = computed(() => {\r\n\treturn homeTotalPrice.value * 0.06\r\n})\r\n// 总价\r\nconst totalPrice = computed(() => {\r\n\treturn homeTotalPrice.value + servicePrice.value + taxPrice.value\r\n})\r\n\r\nonLoad(() => {\r\n\troomData.value = orderStore.roomData\r\n})\r\n\r\nconst handleBack = () => {\r\n\tuni.navigateBack()\r\n}\r\n// 出来订单确定点击\r\nconst handleOrderClick = async () => {\r\n\tuni.showLoading({\r\n\t\ttitle: '生成订单中',\r\n\t\tmask: true\r\n\t})\r\n\tconst res = await requestService.post('/order', {}, {\r\n\t\ttotalPrice: totalPrice.value,\r\n\t\tstartDate: orderStore.startTime,\r\n\t\tendDate: orderStore.endTime,\r\n\t\ttotalRestNight: orderStore.totalDays,\r\n\t\tlistId: orderStore.roomData.id\r\n\t})\r\n\torderStore.orderMessage = res.order\r\n\tuni.navigateTo({\r\n\t\turl: `/pages/confirm-pay/confirm-pay?`\r\n\t})\r\n\t\r\n}\r\n\t\n</script>\n\n<style scoped lang=\"scss\">\n\r\n.apply-order {\r\n\t.bar {\r\n\t\tpadding: 40rpx;\r\n\t}\r\n\t\r\n\t.header {\r\n\t\t.part1 {\r\n\t\t\tdisplay: flex;\r\n\t\t\theight: 150rpx;\r\n\t\t\tpadding-bottom: 40rpx;\r\n\t\t\tborder-bottom: 1rpx solid rgba(0, 0, 0, 0.1);\r\n\t\t\t.img {\r\n\t\t\t\theight: 150rpx;\r\n\t\t\t\twidth: 150rpx;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t\tmargin-right: 40rpx;\r\n\t\t\t}\r\n\t\t\t.text {\r\n\t\t\t\t.part1-title {\r\n\t\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\t\tfont-weight: 600;\r\n\t\t\t\t}\r\n\t\t\t\t.desc {\r\n\t\t\t\t\tmargin: 10rpx 0;\r\n\t\t\t\t\tfont-size: 12rpx\r\n\t\t\t\t}\r\n\t\t\t\t.score {\r\n\t\t\t\t\tmargin-top: 10rpx;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t.part2 {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding: 40rpx 0;\r\n\t\t\t.text {\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tmargin-right: 40rpx;\r\n\t\t\t}\r\n\t\t\timage {\r\n\t\t\t\theight: 100rpx;\r\n\t\t\t\twidth: 100rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.trip-message {\r\n\t\tborder-top: 15rpx solid rgba(0, 0, 0, 0.1);\r\n\t\tborder-bottom: 15rpx solid rgba(0, 0, 0, 0.1);\r\n\t\t.title {\r\n\t\t\tfont-size: 48rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t}\r\n\t\t.date {\r\n\t\t\t.part {\r\n\t\t\t\tmargin-top: 40rpx;\r\n\t\t\t\t.tag {\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.price-detail {\r\n\t\tborder-bottom: 15rpx solid rgba(0, 0, 0, 0.1);\r\n\t\t.title {\r\n\t\t\tfont-size: 48rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t}\r\n\t\t.item {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t\t.key {\r\n\t\t\t\tfont-weight: 400;\r\n\t\t\t}\r\n\t\t\t.value {\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.end {\r\n\t\t\tpadding: 20rpx 0;\r\n\t\t\tborder-top: 1rpx solid rgba(0, 0, 0, 0.1);\r\n\t\t}\r\n\t}\r\n\t.base-rule {\r\n\t\tborder-bottom: 15rpx solid rgba(0, 0, 0, 0.1);\r\n\t\t.title {\r\n\t\t\tfont-size: 48rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t}\r\n\t\t.desc {\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t}\r\n\t\t.list {\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t\t.item {\r\n\t\t\t\tmargin-top: 10rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.confirm-order {\r\n\t\t.remind {\r\n\t\t\tfont-size: 12rpx;\r\n\t\t}\r\n\t\t.order-btn {\r\n\t\t\tmargin-top: 40rpx;\r\n\t\t\tbackground-color: #da0b64;\r\n\t\t\tcolor: white;\r\n\t\t\theight: 80rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t}\r\n}\r\n\n</style>\n","import MiniProgramPage from 'E:/project_all/uni-app/seekstay/pages/apply-order/apply-order.vue'\nwx.createPage(MiniProgramPage)"],"names":["useOrderStore","ref","computed","onLoad","uni","requestService"],"mappings":";;;;;;;;;;;;;;;;;;;;AA6FA,UAAM,aAAaA,iBAAAA,cAAe;AAClC,UAAM,WAAWC,cAAAA,IAAK;AAEtB,UAAM,iBAAiBC,cAAQ,SAAC,MAAM;AACrC,aAAO,SAAS,MAAM,QAAQ,WAAW;AAAA,IAC1C,CAAC;AAED,UAAM,eAAeA,cAAQ,SAAC,MAAM;AACnC,aAAO,eAAe,QAAQ;AAAA,IAC/B,CAAC;AAED,UAAM,WAAWA,cAAQ,SAAC,MAAM;AAC/B,aAAO,eAAe,QAAQ;AAAA,IAC/B,CAAC;AAED,UAAM,aAAaA,cAAQ,SAAC,MAAM;AACjC,aAAO,eAAe,QAAQ,aAAa,QAAQ,SAAS;AAAA,IAC7D,CAAC;AAEDC,kBAAAA,OAAO,MAAM;AACZ,eAAS,QAAQ,WAAW;AAAA,IAC7B,CAAC;AAED,UAAM,aAAa,MAAM;AACxBC,oBAAAA,MAAI,aAAc;AAAA,IACnB;AAEA,UAAM,mBAAmB,YAAY;AACpCA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAE;AACD,YAAM,MAAM,MAAMC,cAAAA,eAAe,KAAK,UAAU,CAAA,GAAI;AAAA,QACnD,YAAY,WAAW;AAAA,QACvB,WAAW,WAAW;AAAA,QACtB,SAAS,WAAW;AAAA,QACpB,gBAAgB,WAAW;AAAA,QAC3B,QAAQ,WAAW,SAAS;AAAA,MAC9B,CAAE;AACD,iBAAW,eAAe,IAAI;AAC9BD,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACP,CAAE;AAAA,IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxIA,GAAG,WAAW,eAAe;"}