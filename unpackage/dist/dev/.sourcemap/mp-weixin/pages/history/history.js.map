{"version":3,"file":"history.js","sources":["pages/history/history.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaGlzdG9yeS9oaXN0b3J5LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"history\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"title\">心愿单</view>\r\n\t\t\t<view class=\"edit\" @click=\"handleEdit\">编辑</view>\r\n\t\t</view>\r\n\t\t<view class=\"collect-list\">\r\n\t\t\t<template v-for=\"item in historyRooms\" :key=\"item?.id\">\r\n\t\t\t\t<view class=\"room-content\" @click=\"handleDetailClick(item?.id)\">\r\n\t\t\t\t\t<image @click=\"handleDelete(item?.id)\" v-show=\"showDelete\" class=\"delete\" src=\"@/static/img/delete.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<image class=\"room-cover\" :src=\"item?.imgUrl[0]\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"room-title\">{{ item?.location }}</view>\r\n\t\t\t\t\t<view class=\"collect-time\">时间：{{ item?.collectionTime }}</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t</view>\r\n\t\t<view class=\"bottom\">暂无更多收藏记录~</view>\r\n\t</view>\n</template>\n\n<script setup>\nimport { onShow, onPullDownRefresh } from '@dcloudio/uni-app'\r\nimport requestService from '../../service/index.js'\r\nimport { ref } from 'vue';\nimport { tokenNavigateTo } from '../../utils/tokenNavigateTo.js';\n\r\nconst historyRooms = ref()\r\nconst showDelete = ref(false)\r\n\r\nonPullDownRefresh(() => {\r\n\tsetTimeout(() => {\r\n\t\tuni.stopPullDownRefresh()\r\n\t}, 1000)\r\n})\r\n\r\nonShow(async () => {\r\n\tconst token = uni.getStorageSync('user_token')\r\n\tif(!token) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: \"请登录后查看\",\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t\tuni.redirectTo({\r\n\t\t\turl: '/subPackages/user/login/login'\r\n\t\t})\r\n\t}\r\n\tconst res = await requestService.get('/collect', {}, {})\r\n\tif(res.status === 401 && token) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '登录已过期，请重新登录',\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t\tuni.redirectTo({\r\n\t\t\turl: '/subPackages/user/login/login'\r\n\t\t})\r\n\t}\r\n\thistoryRooms.value = res.data.list\r\n})\r\n// 处理编辑事件\r\nconst handleEdit = () => {\r\n\tshowDelete.value = !showDelete.value\r\n}\r\n// 处理详情跳转事件\r\nconst handleDetailClick = (id) => {\r\n\tif(!showDelete.value) {\r\n\t\ttokenNavigateTo(`/subPackages/order/room-detail/room-detail?id=${id}`, true)\r\n\t}\r\n}\r\n// 处理删除收藏事件\r\nconst handleDelete = (id) => {\r\n\trequestService.delete('/collect', {}, {listId: id})\r\n\thistoryRooms.value = historyRooms.value.filter(item => item.id !== id)\r\n}\r\n\n</script>\n\n<style scoped lang=\"scss\">\r\n\t.history {\r\n\t\tpadding: 40rpx;\r\n\t\t.header {\r\n\t\t\tdisplay: flex;\r\n\t\t\tmargin-bottom: 80rpx;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\t.title {\r\n\t\t\t\tfont-size: 64rpx;\r\n\t\t\t\tfont-weight: 400;\r\n\t\t\t}\r\n\t\t\t.edit {\r\n\t\t\t\talign-self: flex-end;\r\n\t\t\t\tborder-bottom: 1rpx solid black;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\t&:hover {\r\n\t\t\t\t\tcolor: #636363;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t.collect-list {\r\n\t\t\tdisplay: grid;\r\n\t\t\tgrid-template-columns: repeat(2, 1fr);\r\n\t\t\tcolumn-gap: 10rpx;\r\n\t\t\trow-gap: 20rpx;\r\n\t\t\tjustify-content: center;\r\n\t\t\t\r\n\t\t\t.room-content {\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\ttransition: all 1s ease-out;\r\n\t\t\t\t.delete {\r\n\t\t\t\t\twidth: 50rpx;\r\n\t\t\t\t\theight: 50rpx;\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\ttop: 10rpx;\r\n\t\t\t\t\tleft: 10rpx;\r\n\t\t\t\t\tz-index: 1;\r\n\t\t\t\t}\r\n\t\t\t\t.room-cover {\r\n\t\t\t\t\twidth: 40vw;\r\n\t\t\t\t\theight: 40vw;\r\n\t\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t\t.room-title {\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t}\r\n\t\t\t\t.collect-time {\r\n\t\t\t\t\tfont-size: 12rpx;\r\n\t\t\t\t\tcolor: #989898;\r\n\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t.bottom {\r\n\t\t\t\tmargin-top: 40rpx;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tcolor: #636363;\r\n\t\t\t}\r\n\t\t}\r\n</style>\n","import MiniProgramPage from 'E:/project_all/SeekStay/seekstay/pages/history/history.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onPullDownRefresh","uni","onShow","requestService","tokenNavigateTo"],"mappings":";;;;;;;;AA0BA,UAAM,eAAeA,cAAAA,IAAK;AAC1B,UAAM,aAAaA,cAAG,IAAC,KAAK;AAE5BC,kBAAAA,kBAAkB,MAAM;AACvB,iBAAW,MAAM;AAChBC,sBAAAA,MAAI,oBAAqB;AAAA,MACzB,GAAE,GAAI;AAAA,IACR,CAAC;AAEDC,kBAAAA,OAAO,YAAY;AAClB,YAAM,QAAQD,cAAAA,MAAI,eAAe,YAAY;AAC7C,UAAG,CAAC,OAAO;AACVA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACR,CAAG;AAAA,MACD;AACD,YAAM,MAAM,MAAME,cAAc,eAAC,IAAI,YAAY,CAAE,GAAE,EAAE;AACvD,UAAG,IAAI,WAAW,OAAO,OAAO;AAC/BF,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACR,CAAG;AAAA,MACD;AACD,mBAAa,QAAQ,IAAI,KAAK;AAAA,IAC/B,CAAC;AAED,UAAM,aAAa,MAAM;AACxB,iBAAW,QAAQ,CAAC,WAAW;AAAA,IAChC;AAEA,UAAM,oBAAoB,CAAC,OAAO;AACjC,UAAG,CAAC,WAAW,OAAO;AACrBG,8BAAAA,gBAAgB,iDAAiD,EAAE,IAAI,IAAI;AAAA,MAC3E;AAAA,IACF;AAEA,UAAM,eAAe,CAAC,OAAO;AAC5BD,oBAAc,eAAC,OAAO,YAAY,CAAE,GAAE,EAAC,QAAQ,GAAE,CAAC;AAClD,mBAAa,QAAQ,aAAa,MAAM,OAAO,UAAQ,KAAK,OAAO,EAAE;AAAA,IACtE;;;;;;;;;;;;;;;;;;;;;ACvEA,GAAG,WAAW,eAAe;"}