{"version":3,"file":"set-user.js","sources":["subPackages/user/set-user/set-user.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFja2FnZXNcdXNlclxzZXQtdXNlclxzZXQtdXNlci52dWU"],"sourcesContent":["<template>\n\t<view class=\"register\">\r\n\t\t<uni-nav-bar\r\n\t\t  :fixed=\"true\"\r\n\t\t  background-color=\"#c5b6a0\"\r\n\t\t  status-bar\r\n\t\t  left-icon=\"left\"\r\n\t\t  left-text=\"返回\"\r\n\t\t  title=\"输入个人信息\"\r\n\t\t  @clickLeft=\"handleBack\"\r\n\t\t/>\r\n\t\t<view class=\"form-data\">\r\n\t\t\t<uni-forms ref=\"formRef\" :modelValue=\"formData\">\r\n\t\t\t\t<uni-forms-item label=\"用户名\" name=\"name\">\r\n\t\t\t\t\t<uni-easyinput  v-model=\"formData.name\" placeholder=\"请输入昵称\" primaryColor=\"#c4b8a1\"/>\r\n\t\t\t\t</uni-forms-item>\r\n\t\t\t\t<uni-forms-item label=\"密码\" name=\"password\">\r\n\t\t\t\t\t<uni-easyinput type=\"password\"  v-model=\"formData.password\" placeholder=\"6-16位字符\" primaryColor=\"#c4b8a1\" />\r\n\t\t\t\t</uni-forms-item>\r\n\t\t\t\t<uni-forms-item label=\"确认密码\" name=\"confirmPassword\">\r\n\t\t\t\t\t<uni-easyinput type=\"password\"  v-model=\"formData.confirmPassword\" placeholder=\"6-16位字符\" primaryColor=\"#c4b8a1\" />\r\n\t\t\t\t</uni-forms-item>\r\n\t\t\t</uni-forms>\r\n\t\t\t<button class=\"btn\" @click=\"handleSubmit\" style=\"backgroundColor: #7f6147; color: white; border-radius: 40rpx; margin-top: 250rpx;\">注册</button>\r\n\t\t</view>\r\n\r\n\r\n\t\t\t\r\n\r\n\t</view>\n</template>\n\n<script setup>\nimport { reactive, ref } from 'vue';\nimport { onReady } from \"@dcloudio/uni-app\";\r\nimport requestService from '@/service/index.js'\r\n\r\nconst formRef = ref()\r\n// 表单数据\r\nconst formData = reactive({\r\n\tname: '',\r\n\tpassword: '',\r\n\tconfirmPassword: ''\r\n})\r\n// 校验规则\r\nconst rules = {\r\n\tname: {\r\n\t\trules: [\r\n\t\t\t{\r\n\t\t\t\trequired: true,\r\n\t\t\t\terrorMessage: '请输入手机号或用户名'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tmaxLength: 10,\r\n\t\t\t\terrorMessage: '用户名长度不能超过10位'\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\tpassword: {\r\n\t\trules: [\r\n\t\t\t{\r\n\t\t\t\trequired: true,\r\n\t\t\t\terrorMessage: '请输入密码'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tminLength: 6,\r\n\t\t\t\tmaxLength: 16,\r\n\t\t\t\terrorMessage: '密码长度在6-16个字符之间'\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\tconfirmPassword: {\r\n\t\trules: [\r\n\t\t\t{\r\n\t\t\t\trequired: true,\r\n\t\t\t\terrorMessage: '请确认密码'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalidateFunction: (rule, value, data, callback) => {\r\n\t\t\t\t\tif(value !== formData.password) {\r\n\t\t\t\t\t\tcallback('两次输入密码不一致，请检查')\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n}\r\nonReady(() => {\r\n\t// 添加校验规则\r\n\tformRef.value.setRules(rules)\r\n})\r\n\r\n// 处理表单提交事件\r\nconst handleSubmit = () => {\r\n\tformRef.value.validate().then(res => {\r\n\t\trequestService.post('/register', {},  {\r\n\t\t\tname: res.name,\r\n\t\t\tpassword: res.password\r\n\t\t}).then(res => {\r\n\t\t\t// 注册成功\r\n\t\t\tif(res.code !== -1002) {\r\n\t\t\t\t// 1.缓存本地token\r\n\t\t\t\tuni.setStorageSync(\r\n\t\t\t\t\t'user_token',\r\n\t\t\t\t\tres.data.token\r\n\t\t\t\t)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '注册成功'\r\n\t\t\t\t})\r\n\t\t\t\t// 2.返回登录前跳转页面\r\n\t\t\t\tuni.switchTab({\r\n\t\t\t\t\turl: '/pages/search/search'\r\n\t\t\t\t})\r\n\t\t\t} // 注册失败\r\n\t\t\telse {\r\n\t\t\t\t// 提示用户名重复\r\n\t\t\t\trules.name.rules.push({\r\n\t\t\t\t\tvalidateFunction: (rule, value, data, callback) => {\r\n\t\t\t\t\t\t\tcallback(res.message)\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tformRef.value.setRules(rules)\r\n\t\t\t\tformRef.value.validate()\r\n\t\t\t\trules.name.rules.pop()\r\n\t\t\t}\r\n\t\t})\r\n\t}).catch(err => {\r\n\t\tconsole.log(err);\r\n\t})\r\n}\r\n\r\nconst handleBack = () => {\r\n\tuni.navigateBack()\r\n}\r\n\n</script>\n\n<style scoped lang=\"scss\">\n.register {\r\n\theight: 100vh;\r\n\twidth: 100vw;\r\n\tbackground-color: #c4b8a1;\r\n\r\n\t.form-data {\r\n\t\tmargin: 150rpx 50rpx;\r\n\t\t\r\n\t}\r\n\t\r\n\t.btn{\r\n\t\theight: 80rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n}\r\n\r\n\r\n\n</style>\n","import MiniProgramPage from 'E:/project_all/SeekStay/seekstay/subPackages/user/set-user/set-user.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","onReady","requestService","res","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;AAqCA,UAAM,UAAUA,cAAAA,IAAK;AAErB,UAAM,WAAWC,cAAAA,SAAS;AAAA,MACzB,MAAM;AAAA,MACN,UAAU;AAAA,MACV,iBAAiB;AAAA,IAClB,CAAC;AAED,UAAM,QAAQ;AAAA,MACb,MAAM;AAAA,QACL,OAAO;AAAA,UACN;AAAA,YACC,UAAU;AAAA,YACV,cAAc;AAAA,UACd;AAAA,UACD;AAAA,YACC,WAAW;AAAA,YACX,cAAc;AAAA,UACd;AAAA,QACD;AAAA,MACD;AAAA,MACD,UAAU;AAAA,QACT,OAAO;AAAA,UACN;AAAA,YACC,UAAU;AAAA,YACV,cAAc;AAAA,UACd;AAAA,UACD;AAAA,YACC,WAAW;AAAA,YACX,WAAW;AAAA,YACX,cAAc;AAAA,UACd;AAAA,QACD;AAAA,MACD;AAAA,MACD,iBAAiB;AAAA,QAChB,OAAO;AAAA,UACN;AAAA,YACC,UAAU;AAAA,YACV,cAAc;AAAA,UACd;AAAA,UACD;AAAA,YACC,kBAAkB,CAAC,MAAM,OAAO,MAAM,aAAa;AAClD,kBAAG,UAAU,SAAS,UAAU;AAC/B,yBAAS,eAAe;AAAA,cACxB;AACD,qBAAO;AAAA,YACP;AAAA,UAED;AAAA,QACD;AAAA,MACD;AAAA,IACF;AACAC,kBAAAA,QAAQ,MAAM;AAEb,cAAQ,MAAM,SAAS,KAAK;AAAA,IAC7B,CAAC;AAGD,UAAM,eAAe,MAAM;AAC1B,cAAQ,MAAM,WAAW,KAAK,SAAO;AACpCC,qCAAe,KAAK,aAAa,IAAK;AAAA,UACrC,MAAM,IAAI;AAAA,UACV,UAAU,IAAI;AAAA,QACjB,CAAG,EAAE,KAAK,CAAAC,SAAO;AAEd,cAAGA,KAAI,SAAS,OAAO;AAEtBC,0BAAAA,MAAI;AAAA,cACH;AAAA,cACAD,KAAI,KAAK;AAAA,YACT;AACDC,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,YACZ,CAAK;AAEDA,0BAAAA,MAAI,UAAU;AAAA,cACb,KAAK;AAAA,YACV,CAAK;AAAA,UACD,OACI;AAEJ,kBAAM,KAAK,MAAM,KAAK;AAAA,cACrB,kBAAkB,CAAC,MAAM,OAAO,MAAM,aAAa;AACjD,yBAASD,KAAI,OAAO;AACrB,uBAAO;AAAA,cACP;AAAA,YACN,CAAK;AACD,oBAAQ,MAAM,SAAS,KAAK;AAC5B,oBAAQ,MAAM,SAAU;AACxB,kBAAM,KAAK,MAAM,IAAK;AAAA,UACtB;AAAA,QACJ,CAAG;AAAA,MACH,CAAE,EAAE,MAAM,SAAO;AACfC,sBAAAA,MAAY,MAAA,OAAA,iDAAA,GAAG;AAAA,MACjB,CAAE;AAAA,IACF;AAEA,UAAM,aAAa,MAAM;AACxBA,oBAAAA,MAAI,aAAc;AAAA,IACnB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvIA,GAAG,WAAW,eAAe;"}