{"version":3,"file":"confirm-pay.js","sources":["subPackages/order/confirm-pay/confirm-pay.vue","D:/download/HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFja2FnZXNcb3JkZXJcY29uZmlybS1wYXlcY29uZmlybS1wYXkudnVl"],"sourcesContent":["<template>\n\t<view class=\"confirm-pay\">\n\t\t<!-- 头部导航 -->\r\n\t\t<uni-nav-bar\r\n\t\t  dark\r\n\t\t  :fixed=\"true\"\r\n\t\t  background-color=\"#c5b6a0\"\r\n\t\t  status-bar\r\n\t\t  left-icon=\"left\"\r\n\t\t  left-text=\"返回\"\r\n\t\t  title=\"确认支付\"\r\n\t\t  @clickLeft=\"handleBack\"\r\n\t\t/>\r\n\t\t<!-- 支付方式 -->\r\n\t\t<view class=\"pay-way\">\r\n\t\t\t<radio-group @change=\"changePayWay\">\r\n\t\t\t\t<view class=\"pay-item\">\r\n\t\t\t\t\t<image src=\"https://img.picgo.net/2025/02/13/wechat-paybea6b0df48d1ac15.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"text\">\r\n\t\t\t\t\t\t微信支付\r\n\t\t\t\t\t\t<view class=\"reconmannd\">推荐微信用户使用</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<label class=\"radio\">\r\n\t\t\t\t\t\t<radio value=\"wechat\"/>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"pay-item\">\r\n\t\t\t\t\t<image src=\"https://img.picgo.net/2025/02/13/ali-payeb759f8997ced4a4.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"text\">\r\n\t\t\t\t\t\t支付宝支付\r\n\t\t\t\t\t\t<view class=\"reconmannd\">推荐支付宝用户使用</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<label class=\"radio\">\r\n\t\t\t\t\t\t<radio value=\"ali\" />\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</view>\r\n\t\t\t</radio-group>\r\n\t\t</view>\n\t\t<!-- 底部框 -->\r\n\t\t<view class=\"bottom-bar\">\r\n\t\t\t<view class=\"text\">\r\n\t\t\t\t合计：\r\n\t\t\t\t<text style=\"color: #9bc4d1; font-size: 36rpx;\">{{ formatPrice(orderStore.orderMessage.totalPrice, 2) }} ￥</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"\">\r\n\t\t\t\t<button class=\"pay-btn\" type=\"default\" @click=\"handlePayClick\">支付</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n\t\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { onShow } from '@dcloudio/uni-app'\r\nimport { useOrderStore } from '@/store/orderStore.js';\r\nimport { formatPrice } from '@/utils/formatPrice.js';\r\nimport requestService from '@/service/index.js'\n\r\nconst orderStore = useOrderStore()\r\nlet payway = ''\r\n\r\n\r\nonShow(() => {\r\n\tuni.hideLoading()\r\n\tif(!orderStore.orderMessage?.orderNumber) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '请重新进入页面',\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t}\r\n})\n\r\n\r\nconst handleBack = () => {\r\n\tuni.navigateBack()\r\n}\r\n\r\n// 切换支付方式\r\nconst changePayWay = (e) => {\r\n\tpayway = e.detail.value\r\n}\r\n\r\n// 出来支付点击事件\r\nconst handlePayClick = async () => {\r\n\tif(!payway) {\r\n\t\treturn uni.showToast({\r\n\t\t\ttitle: '请先选择支付方式',\r\n\t\t\ticon: 'error'\r\n\t\t})\r\n\t}\r\n\tuni.showLoading({\r\n\t\tmask: true,\r\n\t\ttitle: \"支付中\"\r\n\t})\r\n\tconst res = await requestService.patch('/order/paid', {}, {\r\n\t\torderNumber: orderStore.orderMessage.orderNumber\r\n\t})\r\n\tsetTimeout(() => {\r\n\t\tuni.hideLoading()\r\n\t\tif(res.status !== 201) {\r\n\t\t\treturn uni.showToast({\r\n\t\t\t\ttitle: '支付失败，请重试',\r\n\t\t\t\ticon: 'error'\r\n\t\t\t})\r\n\t\t}\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '支付成功'\r\n\t\t})\r\n\t\tuni.switchTab({\r\n\t\t\turl: '/pages/trip/trip'\r\n\t\t})\r\n\t}, 2000)\r\n}\r\n\n</script>\n\n<style scoped lang=\"scss\">\n.confirm-pay {\r\n\tposition: relative;\r\n\t.pay-item {\r\n\t\tpadding: 20rpx;\r\n\t\tborder-bottom: 1rpx solid rgba(0, 0, 0, 0.1);\r\n\t\talign-items: center;\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3, 1fr);\r\n\t\timage {\r\n\t\t\twidth: 70rpx;\r\n\t\t\theight: 70rpx;\r\n\t\t}\r\n\t\t.reconmannd {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #bdbdbd;\r\n\t\t}\r\n\t\t.radio {\r\n\t\t\tmargin-left: 100rpx;\r\n\t\t}\r\n\t}\r\n\t.bottom-bar {\r\n\t\tposition: fixed;\r\n\t\tbottom: 10rpx;\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\t.text {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t\tmargin-left: 20rpx;\r\n\t\t}\r\n\t\t.pay-btn {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\theight: 64rpx;\r\n\t\t\twidth: 180rpx;\r\n\t\t\tmargin-right: 20rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tbackground-color: #007aff;\r\n\t\t\tcolor: #fff;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\n</style>\n","import MiniProgramPage from 'E:/project_all/SeekStay/seekstay/subPackages/order/confirm-pay/confirm-pay.vue'\nwx.createPage(MiniProgramPage)"],"names":["useOrderStore","onShow","uni","requestService"],"mappings":";;;;;;;;;;;;;;;;AA2DA,UAAM,aAAaA,iBAAAA,cAAe;AAClC,QAAI,SAAS;AAGbC,kBAAAA,OAAO,MAAM;;AACZC,oBAAAA,MAAI,YAAa;AACjB,UAAG,GAAC,gBAAW,iBAAX,mBAAyB,cAAa;AACzCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AAAA,MACD;AAAA,IACF,CAAC;AAGD,UAAM,aAAa,MAAM;AACxBA,oBAAAA,MAAI,aAAc;AAAA,IACnB;AAGA,UAAM,eAAe,CAAC,MAAM;AAC3B,eAAS,EAAE,OAAO;AAAA,IACnB;AAGA,UAAM,iBAAiB,YAAY;AAClC,UAAG,CAAC,QAAQ;AACX,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AAAA,MACD;AACDA,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,QACN,OAAO;AAAA,MACT,CAAE;AACD,YAAM,MAAM,MAAMC,cAAAA,eAAe,MAAM,eAAe,CAAA,GAAI;AAAA,QACzD,aAAa,WAAW,aAAa;AAAA,MACvC,CAAE;AACD,iBAAW,MAAM;AAChBD,sBAAAA,MAAI,YAAa;AACjB,YAAG,IAAI,WAAW,KAAK;AACtB,iBAAOA,cAAAA,MAAI,UAAU;AAAA,YACpB,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAI;AAAA,QACD;AACDA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,QACV,CAAG;AACDA,sBAAAA,MAAI,UAAU;AAAA,UACb,KAAK;AAAA,QACR,CAAG;AAAA,MACD,GAAE,GAAI;AAAA,IACR;;;;;;;;;;;;;;;;;;;;;AChHA,GAAG,WAAW,eAAe;"}