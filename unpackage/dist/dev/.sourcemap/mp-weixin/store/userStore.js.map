{"version":3,"file":"userStore.js","sources":["store/userStore.js"],"sourcesContent":["// 缓存预定房源数据\r\nimport { defineStore } from 'pinia'\r\nimport requestService from '../service/index.js'\r\n\r\nconst useUserStore = defineStore('user', {\r\n\tstate: () => {\r\n\t\treturn {\r\n\t\t\tphoneNumber: '',\r\n\t\t\temail: '',\r\n\t\t\tintroduce: '',\r\n\t\t\tavatarUrl: 'https://img.picgo.net/2025/02/12/imagese3b794525e1c26a9.jpg',\r\n\t\t\tname: ''\r\n\t\t}\r\n\t},\r\n\tactions: {\r\n\t\t// 拿取用户数据\r\n\t\tasync fetchUserData() {\r\n\t\t\tconst res = await requestService.get('/profile')\r\n\t\t\tif(res.data?.avatar_url) {\r\n\t\t\t\tthis.avatarUrl = res.data?.avatar_url\r\n\t\t\t}\r\n\t\t\tthis.phoneNumber = res.data?.phone_number,\r\n\t\t\tthis.email = res.data?.email\r\n\t\t\tthis.introduce = res.data?.introduce\r\n\t\t\tthis.name = res.data?.name\r\n\t\t\treturn res\r\n\t\t},\r\n\t\t// 修改用户数据\r\n\t\tasync updateUserData(updatedData) {\r\n\t\t\tconst { phoneNumber, email, introduce } = updatedData\r\n\t\t\tif(phoneNumber) {\r\n\t\t\t\tawait requestService.patch('/profile/phone', {}, {\r\n\t\t\t\t\tphone: phoneNumber,\r\n\t\t\t\t})\r\n\t\t\t\tthis.phoneNumber = phoneNumber\r\n\t\t\t}\r\n\t\t\tif(email) {\r\n\t\t\t await requestService.patch('/profile/email', {}, {\r\n\t\t\t\t\temail,\r\n\t\t\t\t})\r\n\t\t\t\tthis.email = email\r\n\t\t\t}\r\n\t\t\tif(introduce) {\r\n\t\t\t\tawait requestService.patch('/profile/introduce', {}, {\r\n\t\t\t\t\tintroduce,\r\n\t\t\t\t})\r\n\t\t\t\tthis.introduce = introduce\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 头像上传\r\n\t\tasync upLoadAvatar(filePath) {\r\n\t\t\tconst token = uni.getStorageSync('user_token')\r\n\t\t\tuni.uploadFile({\r\n\t\t\t\turl: 'http://47.108.24.123:3004/file/avatar', //仅为示例，非真实的接口地址\r\n\t\t\t\tfilePath: filePath,\r\n\t\t\t\tname: 'avatar',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Authorization': `Bearer ${token}`\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tthis.avatarUrl = JSON.parse(res.data).avatarUrl\r\n\t\t\t\t\tconsole.log(this.avatarUrl);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n})\r\n\r\nexport { useUserStore }"],"names":["defineStore","requestService","uni"],"mappings":";;;AAIK,MAAC,eAAeA,cAAW,YAAC,QAAQ;AAAA,EACxC,OAAO,MAAM;AACZ,WAAO;AAAA,MACN,aAAa;AAAA,MACb,OAAO;AAAA,MACP,WAAW;AAAA,MACX,WAAW;AAAA,MACX,MAAM;AAAA,IACN;AAAA,EACD;AAAA,EACD,SAAS;AAAA;AAAA,IAER,MAAM,gBAAgB;;AACrB,YAAM,MAAM,MAAMC,6BAAe,IAAI,UAAU;AAC/C,WAAG,SAAI,SAAJ,mBAAU,YAAY;AACxB,aAAK,aAAY,SAAI,SAAJ,mBAAU;AAAA,MAC3B;AACD,WAAK,eAAc,SAAI,SAAJ,mBAAU,cAC7B,KAAK,SAAQ,SAAI,SAAJ,mBAAU;AACvB,WAAK,aAAY,SAAI,SAAJ,mBAAU;AAC3B,WAAK,QAAO,SAAI,SAAJ,mBAAU;AACtB,aAAO;AAAA,IACP;AAAA;AAAA,IAED,MAAM,eAAe,aAAa;AACjC,YAAM,EAAE,aAAa,OAAO,UAAW,IAAG;AAC1C,UAAG,aAAa;AACf,cAAMA,6BAAe,MAAM,kBAAkB,IAAI;AAAA,UAChD,OAAO;AAAA,QACZ,CAAK;AACD,aAAK,cAAc;AAAA,MACnB;AACD,UAAG,OAAO;AACT,cAAMA,6BAAe,MAAM,kBAAkB,IAAI;AAAA,UAChD;AAAA,QACL,CAAK;AACD,aAAK,QAAQ;AAAA,MACb;AACD,UAAG,WAAW;AACb,cAAMA,6BAAe,MAAM,sBAAsB,IAAI;AAAA,UACpD;AAAA,QACL,CAAK;AACD,aAAK,YAAY;AAAA,MACjB;AAAA,IACD;AAAA;AAAA,IAED,MAAM,aAAa,UAAU;AAC5B,YAAM,QAAQC,cAAAA,MAAI,eAAe,YAAY;AAC7CA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA;AAAA,QACL;AAAA,QACA,MAAM;AAAA,QACN,QAAQ;AAAA,UACP,iBAAiB,UAAU,KAAK;AAAA,QAChC;AAAA,QACD,SAAS,CAAC,QAAQ;AACjB,eAAK,YAAY,KAAK,MAAM,IAAI,IAAI,EAAE;AACtCA,uEAAY,KAAK,SAAS;AAAA,QAC1B;AAAA,MACL,CAAI;AAAA,IACD;AAAA,EACD;AACF,CAAC;;"}