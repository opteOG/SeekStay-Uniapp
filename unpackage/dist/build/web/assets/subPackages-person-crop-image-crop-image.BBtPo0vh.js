import{s as t,W as e,X as i,Y as h,P as s,Z as a,B as o,O as r,_ as n,o as d,c as l,w as c,g,a as p,z as m,j as f,F as w,k as u,f as x,d as y,$ as b,m as v,i as k,E as S,r as I,a0 as W,a1 as z}from"./index-CXRbaKsi.js";import{_ as H}from"./uni-nav-bar.pIin5XDL.js";import{_ as B,r as T}from"./uni-app.es.4GHwWxH-.js";import{u as C}from"./userStore.Bb1cC01o.js";import"./uni-icons.CASMTA-H.js";import"./index.TDGrnhG4.js";var P={x:0,y:0},L=1,Y=1,X=0,_=[],M={},E={},F={},$="",R=0,N={left:0,right:0,top:0,bottom:0},A=0,j="H5";function D(t,e){return t>0&&e<0?t:t<0&&e>0?e:t>0&&e>0?Math.min(t,e):0}function G(t){var e=parseFloat(t.toFixed(6));return 1e-6===e||-1e-6===e?0:e}function q(t,e){var i=t-e;return i<0?i<-1e-6:i<1e-6}function O(t,e,i,h,s,a){if("number"==typeof e){if(i&&(r=e,n=s,Math.abs(r-n)<=1e-6)){var o=G(e*a);return o<=h?o:h}return e}var r,n;return t}function Z(t,e,i){"H5"===j&&(t[e]=i)}function J(t){var e=t[1].pageX-t[0].pageX,i=t[1].pageY-t[0].pageY;return{c:Math.sqrt(Math.pow(e,2)+Math.pow(i,2)),x:t[1].pageX-e/2,y:t[1].pageY-i/2}}function K(t,e,i,h){return G(h?Math.max(Math.min(t,e),i):Math.min(Math.max(t,e),i))}function Q(t,e,i){var h=G((M.height-M.width)/2);return{x:K(t.x,-M.height+h+F.width+F.left,F.left+h,e),y:K(t.y,-M.width-h+F.height+F.top,F.top-h,i)}}function U(t){if(P.x+=t.x||0,P.y+=t.y||0,t.check&&F.checkRange){var e=function(t){if(1==X/90%2){if(F.width===F.height)return Q(t,M.height<F.height,M.width<F.width);var e=M.height<F.width&&M.width<F.height;if(M.width<F.height||M.height<F.width){if(F.width<F.height&&M.width<M.height)return e?Q(t,F.width<F.height,F.width<F.height):Q(t,!1,!0);if(F.height<F.width&&M.height<M.width)return e?Q(t,F.height<F.width,F.height<F.width):Q(t,!0,!1)}return M.height>=F.width&&M.width>=F.height?Q(t,!1,!1):e?F.height<F.width?Q(t,!0,!0):Q(t,F.width<F.height,F.width<F.height):M.height<F.width&&!M.width<F.height?Q(t,!0,!1):!M.height<F.width&&M.width<F.height?Q(t,!1,!0):Q(t,M.height<F.height,M.width<F.width)}return{x:K(t.x,-M.width+F.width+F.left,F.left,M.width<F.width),y:K(t.y,-M.height+F.height+F.top,F.top,M.height<F.height)}}(P);P.x===e.x&&P.y===e.y||(P=e)}var i,h,s,a=(M.width-M.oldWidth)/2,o=(M.height-M.oldHeight)/2;Z(t.instance,"imageStyles",{width:M.oldWidth+"px",height:M.oldHeight+"px",transform:(M.gpu?"translateZ(0) ":"")+"translate("+(P.x+a)+"px, "+(P.y+o)+"px) rotate("+X+"deg) scale("+L+")"}),i=t.instance,h="dataChange",s={width:M.width,height:M.height,x:P.x,y:P.y,rotate:X},"H5"===j&&i[h](s)}function V(t){if(Z(t.instance,"maskStylesList",[{left:0,width:F.left+N.left+"px",top:0,bottom:0,"z-index":F.zIndex+2},{left:F.right+N.right+"px",right:0,top:0,bottom:0,"z-index":F.zIndex+2},{left:F.left+N.left+"px",width:F.width+N.right-N.left+"px",top:0,height:F.top+N.top+"px","z-index":F.zIndex+2},{left:F.left+N.left+"px",width:F.width+N.right-N.left+"px",top:F.bottom+N.bottom+"px",bottom:0,"z-index":F.zIndex+2}]),F.showBorder&&Z(t.instance,"borderStyles",{left:F.left+N.left+"px",top:F.top+N.top+"px",width:F.width+N.right-N.left+"px",height:F.height+N.bottom-N.top+"px","z-index":F.zIndex+3}),F.showGrid&&Z(t.instance,"gridStylesList",[{"border-width":"1px 0 0 0",left:F.left+N.left+"px",right:F.right+N.right+"px",top:F.top+N.top+(F.height+N.bottom-N.top)/3-.5+"px",width:F.width+N.right-N.left+"px","z-index":F.zIndex+3},{"border-width":"1px 0 0 0",left:F.left+N.left+"px",right:F.right+N.right+"px",top:F.top+N.top+2*(F.height+N.bottom-N.top)/3-.5+"px",width:F.width+N.right-N.left+"px","z-index":F.zIndex+3},{"border-width":"0 1px 0 0",top:F.top+N.top+"px",bottom:F.bottom+N.bottom+"px",left:F.left+N.left+(F.width+N.right-N.left)/3-.5+"px",height:F.height+N.bottom-N.top+"px","z-index":F.zIndex+3},{"border-width":"0 1px 0 0",top:F.top+N.top+"px",bottom:F.bottom+N.bottom+"px",left:F.left+N.left+2*(F.width+N.right-N.left)/3-.5+"px",height:F.height+N.bottom-N.top+"px","z-index":F.zIndex+3}]),F.showAngle&&Z(t.instance,"angleStylesList",[{"border-width":F.angleBorderWidth+"px 0 0 "+F.angleBorderWidth+"px",left:F.left+N.left-F.angleBorderWidth+"px",top:F.top+N.top-F.angleBorderWidth+"px","z-index":F.zIndex+3},{"border-width":F.angleBorderWidth+"px "+F.angleBorderWidth+"px 0 0",left:F.right+N.right-F.angleSize+"px",top:F.top+N.top-F.angleBorderWidth+"px","z-index":F.zIndex+3},{"border-width":"0 0 "+F.angleBorderWidth+"px "+F.angleBorderWidth+"px",left:F.left+N.left-F.angleBorderWidth+"px",top:F.bottom+N.bottom-F.angleSize+"px","z-index":F.zIndex+3},{"border-width":"0 "+F.angleBorderWidth+"px "+F.angleBorderWidth+"px 0",left:F.right+N.right-F.angleSize+"px",top:F.bottom+N.bottom-F.angleSize+"px","z-index":F.zIndex+3}]),F.radius>0){var e=F.radius;F.width===F.height&&F.radius>=F.width/2?e=F.width/2:F.width!==F.height&&(e=Math.min(F.width/2,F.height/2,e)),Z(t.instance,"circleBoxStyles",{left:F.left+N.left+"px",top:F.top+N.top+"px",width:F.width+N.right-N.left+"px",height:F.height+N.bottom-N.top+"px","z-index":F.zIndex+2}),Z(t.instance,"circleStyles",{"box-shadow":"0 0 0 "+Math.max(F.width,F.height)+"px rgba(51, 51, 51, 0.8)","border-radius":e+"px"})}}function tt(t){var e=L;return e!==(L=Math.min(Math.max(t.scale+L,Y),M.maxScale))&&(M.width=G(M.oldWidth*L),M.height=G(M.oldHeight*L),t.x=G((t.x-P.x)*(1-L/e)),t.y=G((t.y-P.y)*(1-L/e)),U(t),!0)}function et(t){for(var e=[],i=t?t.length:0,h=0;h<i;h++)e[h]={pageX:t[h].pageX,pageY:t[h].pageY+E.windowTop};return e}var it=!1;const ht={mixins:[{data:()=>({imageStyles:{},maskStylesList:[{},{},{},{}],borderStyles:{},gridStylesList:[{},{},{},{}],angleStylesList:[{},{},{},{}],circleBoxStyles:{},circleStyles:{}}),created(){"H5"===j&&window.addEventListener("mousewheel",(async t=>{var e=et([t]);M.src&&tt({instance:await this.getInstance(),check:!0,scale:t.deltaY>0?-.05:.05,x:e[0].pageX,y:e[0].pageY})}))},mounted(){"H5"===j&&this.initH5Events()},setPlatform(t){j=t},methods:{getTouchEvent:t=>(t.touches=[{pageX:t.pageX,pageY:t.pageY}],t),initH5Events(){const t=document.getElementById("pic-preview");null==t||t.addEventListener("mousedown",((t,e)=>{it=!0,this.touchstart(this.getTouchEvent(t))})),null==t||t.addEventListener("mousemove",(t=>{it&&this.touchmove(this.getTouchEvent(t))})),null==t||t.addEventListener("mouseup",(t=>{it=!1,this.touchend(this.getTouchEvent(t))})),null==t||t.addEventListener("mouseleave",(t=>{it=!1,this.touchend(this.getTouchEvent(t))}))},async getInstance(){if("H5"===j)return Promise.resolve(this)},initObserver:async function(t,e,i,h){if(t&&(!M.src||A!==t.timestamp)){A=t.timestamp,M=t.img,E=t.sys,F=t.area,Y=M.minScale,P={x:0,y:0},L=1,Y=M.minScale,X=0;const e=await this.getInstance();M.src&&U({instance:e,x:(E.windowWidth-M.width)/2,y:(E.windowHeight+E.windowTop-E.offsetBottom-M.height)/2}),V({instance:e})}},mousewheel:function(t,e){},touchstart:function(t,e){M.src&&(_=et(t.touches),R=F.showAngle?function(t,e){var i=F.angleBorderWidth,h=E.navigation?0:E.windowTop;if(e>=F.top-i+h&&e<=F.top+F.angleSize+i+h){if(t>=F.left-i&&t<=F.left+F.angleSize+i)return 1;if(t>=F.right-F.angleSize-i&&t<=F.right+i)return 2}else if(e>=F.bottom-F.angleSize-i+h&&e<=F.bottom+i+h){if(t>=F.left-i&&t<=F.left+F.angleSize+i)return 3;if(t>=F.right-F.angleSize-i&&t<=F.right+i)return 4}return 0}(_[0].pageX,_[0].pageY):0,$=1===_.length&&0!==R?"stretch":"")},touchmove:async function(t,e){if(M.src){if(t.touches=et(t.touches),"stretch"===$){var i=t.touches[0],h=_[0],s=i.pageX-h.pageX,a=i.pageY-h.pageY;if(0!==s||0!==a){var o=G(F.width*(1-F.minScale)),r=G(F.height*(1-F.minScale));_[0]=i;var n=X/90%2,d=1===n?G((M.height-M.width)/2):0,l=q(1===n?M.height:M.width,F.width),c=q(1===n?M.width:M.height,F.height),g=l&&c,p=F.checkRange&&(l||c),m=!g||G((P.x-F.left)/F.width)<=G((P.y-F.top)/F.height)||F.width>F.height&&M.width<M.height&&1===n;switch(R){case 1:if(s=G(s+N.left),a=G(a+N.top),s>=0&&a>=0){var f=G(P.y+d-F.top),w=G(P.x-d-F.left),u=!(!p||!(w>=0||f>=0))&&D(f,w);s>a&&m?(s>(o=O(o,u,g,w,f,F.width/F.height))&&(s=o),a=G(s*F.height/F.width)):(a>(r=O(r,u,g,f,w,F.height/F.width))&&(a=r),s=G(a*F.width/F.height)),N.left=s,N.top=a}break;case 2:if(s=G(s+N.right),a=G(a+N.top),s<=0&&a>=0){var x=1===n?M.height:M.width;f=G(P.y+d-F.top),w=G(F.right+d-P.x-x),u=!(!p||!(f>=0||w>=0))&&D(f,w);-s>a&&m?(-s>(o=O(o,u,g,w,f,F.width/F.height))&&(s=-o),a=G(-s*F.height/F.width)):(a>(r=O(r,u,g,f,w,F.height/F.width))&&(a=r),s=G(-a*F.width/F.height)),N.right=s,N.top=a}break;case 3:if(s+=G(s+N.left),a+=G(a+N.bottom),s>=0&&a<=0){x=1===n?M.width:M.height,f=G(F.bottom-d-P.y-x),w=G(P.x-d-F.left),u=!(!p||!(w>=0||f>=0))&&D(f,w);s>-a&&m?(s>(o=O(o,u,g,w,f,F.width/F.height))&&(s=o),a=G(-s*F.height/F.width)):(-a>(r=O(r,u,g,f,w,F.height/F.width))&&(a=-r),s=G(-a*F.width/F.height)),N.left=s,N.bottom=a}break;case 4:if(s=G(s+N.right),a=G(a+N.bottom),s<=0&&a<=0){x=1===n?M.height:M.width;var y=1===n?M.width:M.height;f=G(F.bottom-P.y-y-d),w=G(F.right+d-P.x-x),u=!(!p||!(w>=0||f>=0))&&D(f,w);-s>-a&&m?(-s>(o=O(o,u,g,w,f,F.width/F.height))&&(s=-o),a=G(s*F.height/F.width)):(-a>(r=O(r,u,g,f,w,F.height/F.width))&&(a=-r),s=G(a*F.width/F.height)),N.right=s,N.bottom=a}}V({instance:await this.getInstance()})}}else if(2==t.touches.length){h=J(_);var b=J(t.touches);tt({instance:await this.getInstance(),check:!F.bounce,scale:(b.c-h.c)/100,x:b.x,y:b.y}),$="scale"}else"scale"===$||U({instance:await this.getInstance(),check:!F.bounce,x:t.touches[0].pageX-_[0].pageX,y:t.touches[0].pageY-_[0].pageY}),$="move";_=t.touches}},touchend:async function(t,e){if(M.src)if("stretch"===$){var i=N.left,h=N.right,s=N.top,a=N.bottom,o=F.width+h-i,r=F.height+a-s,n=L*(F.width/o)-L;N={left:0,right:0,top:0,bottom:0},V({instance:await this.getInstance()}),tt({instance:await this.getInstance(),scale:n,x:F.left+i+(1===R||3===R?o:0),y:F.top+s+(1===R||2===R?r:0)})}else F.bounce&&U({instance:await this.getInstance(),check:!0})},rotateImage:async function(t){X=(X+(t||90))%360,M.minScale>=1&&F.checkRange&&(Y=1,M.width<F.height?Y=F.height/M.oldWidth:M.height<F.width&&(Y=F.width/M.oldHeight),1!==Y&&tt({instance:await this.getInstance(),scale:Y-L,x:E.windowWidth/2,y:(E.windowHeight-E.offsetBottom)/2}));var e=(P.x+M.width-F.right-(F.left-P.x))/2,i=(P.y+M.height-F.bottom-(F.top-P.y))/2;U({instance:await this.getInstance(),check:!0,x:-e-i,y:-i+e})},rotateImage90:function(){this.rotateImage(90)},rotateImage270:function(){this.rotateImage(270)}}}]},st=t=>{t.$renderjs||(t.$renderjs=[]),t.$renderjs.push("cropper"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.cropper=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),t.mixins.push(ht)},at={name:"qf-image-cropper",props:{src:{type:String,default:""},width:{type:Number,default:300},height:{type:Number,default:300},showBorder:{type:Boolean,default:!0},showGrid:{type:Boolean,default:!0},showAngle:{type:Boolean,default:!0},areaScale:{type:Number,default:.3},minScale:{type:Number,default:1},maxScale:{type:Number,default:5},checkRange:{type:Boolean,default:!0},backgroundColor:{type:String},bounce:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},reverseRotatable:{type:Boolean,default:!1},choosable:{type:Boolean,default:!0},gpu:{type:Boolean,default:!1},angleSize:{type:Number,default:20},angleBorderWidth:{type:Number,default:2},zIndex:{type:[Number,String]},radius:{type:Number,default:0},fileType:{type:String,default:"png"},delay:{type:Number,default:1e3},navigation:{type:Boolean,default:!0}},emits:["crop"],data:()=>({maskList:[{id:"crop-mask-block-1"},{id:"crop-mask-block-2"},{id:"crop-mask-block-3"},{id:"crop-mask-block-4"}],gridList:[{id:"crop-grid-1"},{id:"crop-grid-2"},{id:"crop-grid-3"},{id:"crop-grid-4"}],angleList:[{id:"crop-angle-1"},{id:"crop-angle-2"},{id:"crop-angle-3"},{id:"crop-angle-4"}],imgSrc:"",imgWidth:300,imgHeight:300,widthPercent:75,heightPercent:75,area:{},oldWidth:0,oldHeight:0,sys:t(),scaleWidth:0,scaleHeight:0,rotate:0,offsetX:0,offsetY:0,use2d:!1,canvansWidth:0,canvansHeight:0}),computed:{initData(){return{timestamp:(new Date).getTime(),area:{...this.area,bounce:this.bounce,showBorder:this.showBorder,showGrid:this.showGrid,showAngle:this.showAngle,angleSize:this.angleSize,angleBorderWidth:this.angleBorderWidth,minScale:this.areaScale,widthPercent:this.widthPercent,heightPercent:this.heightPercent,radius:this.radius,checkRange:this.checkRange,zIndex:+this.zIndex||0},sys:this.sys,img:{minScale:this.minScale,maxScale:this.maxScale,src:this.imgSrc,width:this.oldWidth,height:this.oldHeight,oldWidth:this.oldWidth,oldHeight:this.oldHeight,gpu:this.gpu}}},imgProps(){return{width:this.width,height:this.height,src:this.src}}},watch:{imgProps:{handler(t,e){this.imgWidth=Number(t.width)||300,this.imgHeight=Number(t.height)||300;let i=!0;i=!1;let h=this.imgWidth,s=this.imgHeight,a=Math.max(h,s),o=1;a>1365&&(o=1365/a),this.canvansWidth=h*o,this.canvansHeight=s*o,this.use2d=false,this.initArea();const r=t.src||this.imgSrc;r&&this.initImage(r,void 0===e)},immediate:!0}},methods:{dataChange(t){this.scaleWidth=t.width,this.scaleHeight=t.height,this.rotate=t.rotate,this.offsetX=t.x,this.offsetY=t.y},initArea(){this.sys.offsetBottom=e(100)+this.sys.safeAreaInsets.bottom,this.sys.windowTop=this.sys.windowTop||44,this.sys.navigation=this.navigation;let t=this.widthPercent,i=this.heightPercent;this.imgWidth>this.imgHeight?i=i*this.imgHeight/this.imgWidth:this.imgWidth<this.imgHeight&&(t=t*this.imgWidth/this.imgHeight);const h=this.sys.windowWidth>this.sys.windowHeight?this.sys.windowHeight:this.sys.windowWidth,s=h*t/100,a=h*i/100,o=(this.sys.windowWidth-s)/2,r=o+s,n=(this.sys.windowHeight+this.sys.windowTop-this.sys.offsetBottom-a)/2,d=this.sys.windowHeight+this.sys.windowTop-this.sys.offsetBottom-n;this.area={width:s,height:a,left:o,right:r,top:n,bottom:d},this.scaleWidth=s,this.scaleHeight=a},chooseImage(t){i({...t,count:1,success:t=>{this.resetData(),this.initImage(t.tempFiles[0].path)}})},resetData(){this.imgSrc="",this.rotate=0,this.offsetX=0,this.offsetY=0,this.initArea()},initImage(t,e){h({src:t,success:async i=>{e&&this.src===t&&await new Promise((t=>setTimeout(t,50))),this.imgSrc=i.path;let h=i.width/i.height,s=this.area.width/this.area.height;h>1?h>=s?this.scaleWidth=this.scaleHeight/i.height*this.scaleWidth*(i.width/this.scaleWidth):this.scaleHeight=i.height*this.scaleWidth/i.width:h<=s?this.scaleHeight=this.scaleWidth/i.width*this.scaleHeight/(this.scaleHeight/i.height):this.scaleWidth=i.width*this.scaleHeight/i.height,this.oldWidth=+this.scaleWidth.toFixed(2),this.oldHeight=+this.scaleHeight.toFixed(2)},fail:t=>{console.error(t)}})},drawClipImage(t,e,i,h){if(e>0){t.save(),t.beginPath();const i=this.canvansWidth,s=this.canvansHeight;i===s&&e>=i/2?t.arc(i/2,s/2,i/2,0,2*Math.PI):(i!==s&&(e=Math.min(i/2,s/2,e)),t.moveTo(e,0),t.arcTo(i,0,i,s,e),t.arcTo(i,s,0,s,e),t.arcTo(0,s,0,0,e),t.arcTo(0,0,i,0,e),t.closePath()),t.clip(),h&&h(!0),t.restore()}else h&&h(!1)},drawRotateImage(t,e,i){if(0!==e){const h=this.scaleWidth*i/2,s=this.scaleHeight*i/2;t.translate(h,s),t.rotate(e*Math.PI/180),t.translate(-h,-s)}},drawImage(t,e,i){const h=this.canvansWidth/this.area.width;this.backgroundColor&&(t.setFillStyle?t.setFillStyle(this.backgroundColor):t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.canvansWidth,this.canvansHeight)),this.drawClipImage(t,this.radius,h,(()=>{this.drawRotateImage(t,this.rotate,h);const i=this.rotate/90;t.drawImage(e,[this.offsetX-this.area.left,this.offsetY-this.area.top,-(this.offsetX-this.area.left),-(this.offsetY-this.area.top)][i]*h,[this.offsetY-this.area.top,-(this.offsetX-this.area.left),-(this.offsetY-this.area.top),this.offsetX-this.area.left][i]*h,this.scaleWidth*h,this.scaleHeight*h)}))},draw2DImage(t,e,i,h){if(t){const a=t.createImage();a.onload=()=>{this.drawImage(e,a),h&&setTimeout(h,this.delay)},a.onerror=t=>{console.error(t),s()},a.src=i}else this.drawImage(e,i),setTimeout((()=>{e.draw(!1,h)}),200)},canvasToTempFilePath(t,e){a({canvas:t,canvasId:e,x:0,y:0,width:this.canvansWidth,height:this.canvansHeight,destWidth:this.imgWidth,destHeight:this.imgHeight,fileType:this.fileType,success:t=>{this.handleImage(t.tempFilePath)},fail:t=>{s(),o({title:"裁剪失败，生成图片异常！",icon:"none"})}},this)},cropClick(){if(r({title:"裁剪中...",mask:!0}),!this.use2d){const t=n("imgCanvas",this);return t.clearRect(0,0,this.canvansWidth,this.canvansHeight),void this.draw2DImage(null,t,this.imgSrc,(()=>{this.canvasToTempFilePath(null,"imgCanvas")}))}},handleImage(t){s(),this.$emit("crop",{tempFilePath:t})}}};st(at);const ot=B(at,[["render",function(t,e,i,h,s,a){const o=b,r=v,n=k,I=S;return d(),l(n,{class:"image-cropper",style:g({zIndex:i.zIndex}),onWheel:t.cropper.mousewheel},{default:c((()=>[s.use2d?(d(),l(o,{key:0,type:"2d",id:"imgCanvas",class:"img-canvas",style:g({width:`${s.canvansWidth}px`,height:`${s.canvansHeight}px`})},null,8,["style"])):(d(),l(o,{key:1,id:"imgCanvas","canvas-id":"imgCanvas",class:"img-canvas",style:g({width:`${s.canvansWidth}px`,height:`${s.canvansHeight}px`})},null,8,["style"])),p(n,{id:"pic-preview",class:"pic-preview","change:init":t.cropper.initObserver,init:a.initData,onTouchstart:t.cropper.touchstart,onTouchmove:t.cropper.touchmove,onTouchend:t.cropper.touchend},{default:c((()=>[s.imgSrc?(d(),l(r,{key:0,id:"crop-image",class:"crop-image",style:g(t.cropper.imageStyles),src:s.imgSrc,webp:""},null,8,["style","src"])):m("",!0),(d(!0),f(w,null,u(s.maskList,((e,i)=>(d(),l(n,{key:e.id,id:e.id,class:"crop-mask-block",style:g(t.cropper.maskStylesList[i])},null,8,["id","style"])))),128)),i.showBorder?(d(),l(n,{key:1,id:"crop-border",class:"crop-border",style:g(t.cropper.borderStyles)},null,8,["style"])):m("",!0),i.radius>0?(d(),l(n,{key:2,id:"crop-circle-box",class:"crop-circle-box",style:g(t.cropper.circleBoxStyles)},{default:c((()=>[p(n,{class:"crop-circle",id:"crop-circle",style:g(t.cropper.circleStyles)},null,8,["style"])])),_:1},8,["style"])):m("",!0),i.showGrid?(d(!0),f(w,{key:3},u(s.gridList,((e,i)=>(d(),l(n,{key:e.id,id:e.id,class:"crop-grid",style:g(t.cropper.gridStylesList[i])},null,8,["id","style"])))),128)):m("",!0),i.showAngle?(d(!0),f(w,{key:4},u(s.angleList,((e,h)=>(d(),l(n,{key:e.id,id:e.id,class:"crop-angle",style:g(t.cropper.angleStylesList[h])},{default:c((()=>[p(n,{style:g([{width:`${i.angleSize}px`,height:`${i.angleSize}px`}])},null,8,["style"])])),_:2},1032,["id","style"])))),128)):m("",!0)])),_:1},8,["change:init","init","onTouchstart","onTouchmove","onTouchend"]),x(t.$slots,"default",{},void 0,!0),p(n,{class:"fixed-bottom safe-area-inset-bottom",style:g({zIndex:a.initData.area.zIndex+99})},{default:c((()=>[(i.rotatable||i.reverseRotatable)&&s.imgSrc?(d(),l(n,{key:0,class:"action-bar"},{default:c((()=>[i.reverseRotatable?(d(),l(n,{key:0,class:"rotate-icon",onClick:t.cropper.rotateImage270},null,8,["onClick"])):m("",!0),i.rotatable?(d(),l(n,{key:1,class:"rotate-icon is-reverse",onClick:t.cropper.rotateImage90},null,8,["onClick"])):m("",!0)])),_:1})):m("",!0),i.choosable?s.imgSrc?(d(),f(w,{key:2},[p(n,{class:"rechoose",onClick:a.chooseImage},{default:c((()=>[y("重选")])),_:1},8,["onClick"]),p(I,{class:"button",size:"mini",onClick:a.cropClick},{default:c((()=>[y("确定")])),_:1},8,["onClick"])],64)):(d(),l(n,{key:3,class:"choose-btn",onClick:a.chooseImage},{default:c((()=>[y("选择图片")])),_:1},8,["onClick"])):(d(),l(n,{key:1,class:"choose-btn",onClick:a.cropClick},{default:c((()=>[y("确定")])),_:1},8,["onClick"]))])),_:1},8,["style"])])),_:3},8,["style","onWheel"])}],["__scopeId","data-v-79e8b294"]]),rt={__name:"crop-image",setup(t){const e=C(),i=t=>{e.upLoadAvatar(t.tempFilePath),W({urls:[t.tempFilePath],indicator:"none"})},h=()=>{z({url:"/pages/profile/profile"})};return(t,e)=>{const s=T(I("uni-nav-bar"),H),a=T(I("qf-image-cropper"),ot),o=k;return d(),l(o,{class:"crop-image"},{default:c((()=>[p(s,{dark:"",fixed:!0,shadow:"","background-color":"#c5b6a0","status-bar":"","left-icon":"left","left-text":"返回",title:"头像上传",onClickLeft:h}),p(a,{width:450,height:450,radius:360,onCrop:i})])),_:1})}}};export{rt as default};
